var version="9.6.0",active_contextmenu=!0;loading_bar&&(/MSIE (\d+\.\d+);/.test(navigator.userAgent)?$(document).ready(function(){$("body").queryLoader2({backgroundColor:"none",minimumTime:100,percentage:!0})}):window.addEventListener("DOMContentLoaded",function(){$("body").queryLoader2({backgroundColor:"none",minimumTime:100,percentage:!0})})); $(document).ready(function(){active_contextmenu&&($.contextMenu({selector:"figure:not(.back-directory), .list-view2 figure:not(.back-directory)",autoHide:!0,build:function(b){b.addClass("selected");var a={callback:function(a,c){switch(a){case "copy_url":var d;d=""+($("#base_url").val()+$("#cur_dir").val());add=b.find("a.link").attr("data-file");""!=add&&null!=add&&(d+=add);add=b.find("h4 a.folder-link").attr("data-file");""!=add&&null!=add&&(d+=add);bootbox.alert('URL:<br/><br/><input type="text" style="height:30px; width:100%;" value="'+ encodeURL(d)+'" />');break;case "unzip":d=$("#sub_folder").val()+$("#fldr_value").val()+b.find("a.link").attr("data-file");$.ajax({type:"POST",url:"ajax_calls.php?action=extract",data:{path:d}}).done(function(b){""!=b?bootbox.alert(b):window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()});break;case "edit_img":d=b.attr("data-name");var f=$("#base_url_true").val()+$("#cur_dir").val()+d;$("#aviary_img").attr("data-name",d);$("#aviary_img").attr("src",f).load(launchEditor("aviary_img", f));break;case "duplicate":var k=b.find("h4").text().trim();bootbox.prompt($("#lang_duplicate").val(),$("#cancel").val(),$("#ok").val(),function(a){if(null!==a&&(a=fix_filename(a),a!=k)){var c=b.find(".rename-file");execute_action("duplicate_file",c.attr("data-path"),c.attr("data-thumb"),a,c,"apply_file_duplicate")}},k);break;case "copy":copy_cut_clicked(b,"copy");break;case "cut":copy_cut_clicked(b,"cut");break;case "paste":paste_to_this_dir();break;case "chmod":chmod(b);break;case "edit_text_file":edit_text_file(b)}}, items:{}};(b.find(".img-precontainer-mini .filetype").hasClass("png")||b.find(".img-precontainer-mini .filetype").hasClass("jpg")||b.find(".img-precontainer-mini .filetype").hasClass("jpeg"))&&image_editor&&(a.items.edit_img={name:$("#lang_edit_image").val(),icon:"edit_img",disabled:!1});a.items.copy_url={name:$("#lang_show_url").val(),icon:"url",disabled:!1};if(b.find(".img-precontainer-mini .filetype").hasClass("zip")||b.find(".img-precontainer-mini .filetype").hasClass("tar")||b.find(".img-precontainer-mini .filetype").hasClass("gz"))a.items.unzip= {name:$("#lang_extract").val(),icon:"extract",disabled:!1};b.find(".img-precontainer-mini .filetype").hasClass("edit-text-file-allowed")&&(a.items.edit_text_file={name:$("#lang_edit_file").val(),icon:"edit",disabled:!1});b.hasClass("directory")||1!=$("#duplicate").val()||(a.items.duplicate={name:$("#lang_duplicate").val(),icon:"duplicate",disabled:!1});b.hasClass("directory")||1!=$("#copy_cut_files_allowed").val()?b.hasClass("directory")&&1==$("#copy_cut_dirs_allowed").val()&&(a.items.copy={name:$("#lang_copy").val(), icon:"copy",disabled:!1},a.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:!1}):(a.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:!1},a.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:!1});0==$("#clipboard").val()||b.hasClass("directory")||(a.items.paste={name:$("#lang_paste_here").val(),icon:"clipboard-apply",disabled:!1});b.hasClass("directory")||1!=$("#chmod_files_allowed").val()?b.hasClass("directory")&&1==$("#chmod_dirs_allowed").val()&&(a.items.chmod={name:$("#lang_file_permission").val(), icon:"key",disabled:!1}):a.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:!1};a.items.sep="----";a.items.info={name:"<strong>"+$("#lang_file_info").val()+"</strong>",disabled:!0};a.items.name={name:b.attr("data-name"),icon:"label",disabled:!0};"img"==b.attr("data-type")&&(a.items.dimension={name:b.find(".img-dimension").html(),icon:"dimension",disabled:!0});a.items.size={name:b.find(".file-size").html(),icon:"size",disabled:!0};a.items.date={name:b.find(".file-date").html(), icon:"date",disabled:!0};return a},events:{hide:function(b){$("figure").removeClass("selected")}}}),$(document).on("contextmenu",function(b){if(!$(b.target).is("figure"))return!1}));$("#full-img").on("click",function(){$("#previewLightbox").lightbox("hide")});$("ul.grid").on("click",".modalAV",function(b){_this=$(this);b.preventDefault();$("#previewAV").removeData("modal");$("#previewAV").modal({backdrop:"static",keyboard:!1});_this.hasClass("audio")?$(".body-preview").css("height","80px"):$(".body-preview").css("height", "345px");$.ajax({url:_this.attr("data-url"),success:function(b){$(".body-preview").html(b)}})});$("ul.grid").on("click",".file-preview-btn",function(b){_this=$(this);b.preventDefault();$.ajax({url:_this.attr("data-url"),success:function(b){bootbox.alert(b)}})});$("input[name=radio-sort]").on("click",function(){var b=$(this).attr("data-item");$(".filters label").removeClass("btn-inverse");$(".filters label").find("i").removeClass("icon-white");$("#filter-input").val("");$("#"+b).addClass("btn-inverse"); $("#"+b).find("i").addClass("icon-white");"ff-item-type-all"==b?$(".grid li").show(300):$(this).is(":checked")&&($(".grid li").not("."+b).hide(300),$(".grid li."+b).show(300))});var a=function(){var b=0;return function(a,c){clearTimeout(b);b=setTimeout(a,c)}}(),c=parseInt($("#file_number").val())>parseInt($("#file_number_limit_js").val())?!1:!0;$("#filter-input").on("keyup",function(){$(".filters label").removeClass("btn-inverse");$(".filters label").find("i").removeClass("icon-white");$("#ff-item-type-all").addClass("btn-inverse"); $("#ff-item-type-all").find("i").addClass("icon-white");var b=fix_filename($(this).val());$(this).val(b);a(function(){c&&$("ul.grid li").each(function(){var a=$(this);""!=b&&-1==a.attr("data-name").toString().toLowerCase().indexOf(b.toLowerCase())?a.hide(100):a.show(100)})},300)}).keypress(function(b){13==b.which&&$("#filter").trigger("click")});$("#filter").on("click",function(){var b=fix_filename($("#filter-input").val());window.location.href=$("#current_url").val()+"&filter="+b});$("#info").on("click", function(){bootbox.alert('<center><img src="img/logo.png" alt="responsive filemanager"/><br/><br/><p><strong>RESPONSIVE filemanager v.'+version+'</strong><br/><a href="http://www.responsivefilemanager.com">responsivefilemanager.com</a></p><br/><p>Copyright \u00a9 <a href="http://www.tecrail.com" alt="tecrail">Tecrail</a> - Alberto Peripolli. All rights reserved.</p><br/><p>License<br/><small><img alt="Creative Commons License" style="border-width:0" src="http://responsivefilemanager.com/license.php" /><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</small></p></center>')}); $("#change_lang_btn").on("click",function(){change_lang()});$("#uploader-btn").on("click",function(){var b=$("#sub_folder").val()+$("#fldr_value").val()+"/",b=b.substring(0,b.length-1);$("#iframe-container").html($("<iframe />",{name:"JUpload",id:"uploader_frame",src:"uploader/index.php?path="+b,frameborder:0,width:"100%",height:360}))});$(".upload-btn").on("click",function(){$(".uploader").show(500)});var d="true"===$("#descending").val();$(".sorter").on("click",function(){_this=$(this);d=$("#sort_by").val()=== _this.attr("data-sort")?!d:!0;c?($.ajax({url:"ajax_calls.php?action=sort&sort_by="+_this.attr("data-sort")+"&descending="+d}).done(function(b){}),sortUnorderedList("ul.grid",d,"."+_this.attr("data-sort")),$(" a.sorter").removeClass("descending").removeClass("ascending"),d?$(".sort-"+_this.attr("data-sort")).addClass("descending"):$(".sort-"+_this.attr("data-sort")).addClass("ascending"),$("#sort_by").val(_this.attr("data-sort")),$("#descending").val(d)):window.location.href=$("#current_url").val()+ "&sort_by="+_this.attr("data-sort")+"&descending="+d});$(".close-uploader").on("click",function(){$(".uploader").hide(500);setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},420)});$("ul.grid").on("click",".preview",function(){var b=$(this);$("#full-img").attr("src",decodeURIComponent(b.attr("data-url")));0==b.hasClass("disabled")&&show_animation();return!0});$("body").on("keypress",function(b){b=String.fromCharCode(b.which);if("'"==b||'"'==b||"\\"==b|| "/"==b)return!1});$("ul.grid").on("click",".rename-file",function(){var b=$(this),a=b.parent().parent().parent(),c=a.find("h4"),d=$.trim(c.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(c){null!==c&&(c=fix_filename(c),c!=d&&execute_action("rename_file",b.attr("data-path"),b.attr("data-thumb"),c,a,"apply_file_rename"))},d)});$("ul.grid").on("click",".rename-folder",function(){var b=$(this),a=b.parent().parent().parent(),c=a.find("h4"),d=$.trim(c.text());bootbox.prompt($("#rename").val(), $("#cancel").val(),$("#ok").val(),function(c){null!==c&&(c=fix_filename(c).replace(".",""),c!=d&&execute_action("rename_folder",b.attr("data-path"),b.attr("data-thumb"),c,a,"apply_folder_rename"))},d)});$("ul.grid").on("click",".delete-file",function(){var b=$(this);bootbox.confirm(b.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(a){1==a&&(execute_action("delete_file",b.attr("data-path"),b.attr("data-thumb"),"","",""),b.parent().parent().parent().parent().remove())})});$("ul.grid").on("click", ".delete-folder",function(){var b=$(this);bootbox.confirm(b.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(a){1==a&&(execute_action("delete_folder",b.attr("data-path"),b.attr("data-thumb"),"","",""),b.parent().parent().parent().remove())})});$(".create-file-btn").on("click",function(){create_text_file()});$(".new-folder").on("click",function(){bootbox.prompt($("#insert_folder_name").val(),$("#cancel").val(),$("#ok").val(),function(b){if(null!==b){b=fix_filename(b).replace(".",""); var a=$("#sub_folder").val()+$("#fldr_value").val()+b;b=$("#cur_dir_thumb").val()+b;$.ajax({type:"POST",url:"execute.php?action=create_folder",data:{path:a,path_thumb:b}}).done(function(b){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300)})}},$("#new_folder").val())});$(".view-controller button").on("click",function(){var b=$(this);$(".view-controller button").removeClass("btn-inverse");$(".view-controller i").removeClass("icon-white");b.addClass("btn-inverse"); b.find("i").addClass("icon-white");$.ajax({url:"ajax_calls.php?action=view&type="+b.attr("data-value")}).done(function(b){""!=b&&bootbox.alert(b)});"undefined"!==typeof $("ul.grid")[0]&&$("ul.grid")[0]&&($("ul.grid")[0].className=$("ul.grid")[0].className.replace(/\blist-view.*?\b/g,""));"undefined"!==typeof $(".sorter-container")[0]&&$(".sorter-container")[0]&&($(".sorter-container")[0].className=$(".sorter-container")[0].className.replace(/\blist-view.*?\b/g,""));var a=b.attr("data-value");$("#view").val(a); $("ul.grid").addClass("list-view"+a);$(".sorter-container").addClass("list-view"+a);1<=b.attr("data-value")?fix_colums(14):($("ul.grid li").css("width",126),$("ul.grid figure").css("width",122))});Modernizr.touch?($("#help").show(),$(".box:not(.no-effect)").swipe({swipeLeft:swipe_reaction,swipeRight:swipe_reaction,threshold:30})):($(".tip").tooltip({placement:"bottom"}),$(".tip-top").tooltip({placement:"top"}),$(".tip-left").tooltip({placement:"left"}),$(".tip-right").tooltip({placement:"right"}), $("body").addClass("no-touch"));$(".paste-here-btn").on("click",function(){0==$(this).hasClass("disabled")&&paste_to_this_dir()});$(".clear-clipboard-btn").on("click",function(){0==$(this).hasClass("disabled")&&clear_clipboard()});Modernizr.csstransforms||($("figure").on("mouseover",function(){0==$("#view").val()&&!1===$("#main-item-container").hasClass("no-effect-slide")&&$(this).find(".box:not(.no-effect)").animate({top:"-26px"},{queue:!1,duration:300})}),$("figure").on("mouseout",function(){0== $("#view").val()&&$(this).find(".box:not(.no-effect)").animate({top:"0px"},{queue:!1,duration:300})}));$(window).resize(function(){fix_colums(28)});fix_colums(14);$("ul.grid").on("click",".link",function(){var b=$(this);window[b.attr("data-function")](b.attr("data-file"),b.attr("data-field_id"))});1==$("#clipboard").val()?toggle_clipboard(!0):toggle_clipboard(!1);$("li.dir, li.file").draggable({revert:!0,distance:20,cursor:"move",helper:function(){$(this).find("figure").find(".box").css("top","0px"); var b=$(this).clone().css("z-index",1E3).find(".box").css("box-shadow","none").css("-webkit-box-shadow","none").parent().parent();$(this).addClass("selected");return b},start:function(){0==$("#view").val()&&$("#main-item-container").addClass("no-effect-slide")},stop:function(){$(this).removeClass("selected");0==$("#view").val()&&$("#main-item-container").removeClass("no-effect-slide")}});$("li.dir").droppable({accept:"ul.grid li",activeClass:"ui-state-highlight",hoverClass:"ui-state-highlight",drop:function(b, a){drag_n_drop_paste(a.draggable.find("figure"),$(this).find("figure"))}});$(document).on("keyup","#chmod_form #chmod_value",function(){chmod_logic(!0)});$(document).on("focusout","#chmod_form #chmod_value",function(){if(null==$("#chmod_form #chmod_value").val().match(/^[0-7]{3}$/)){var b=$("#chmod_form #chmod_value").attr("data-def-value");$("#chmod_form #chmod_value").val(b);chmod_logic(!0)}})}); function create_text_file(){$("#textfile_create_area").parent().parent().remove();var a=$("#lang_filename").val()+': <input type="text" id="create_text_file_name" style="min-height:30px"><br><hr><textarea id="textfile_create_area" style="width:100%;height:150px;"></textarea>';bootbox.dialog(a,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var a=$("#create_text_file_name").val(),d=$("#textfile_create_area").val();if(null!==a){var a=fix_filename(a), b=$("#sub_folder").val()+$("#fldr_value").val()+a,f=$("#cur_dir_thumb").val()+a;$.ajax({type:"POST",url:"execute.php?action=create_file",data:{path:b,path_thumb:f,name:a,new_content:d}}).done(function(b){""!=b&&bootbox.alert(b,function(b){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},500)})})}}}],{header:$("#lang_new_file").val()})} function edit_text_file(a){$("#textfile_edit_area").parent().parent().remove();var c=a.find(".rename-file").attr("data-thumb"),d=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=get_file&sub_action=edit",data:{path:d}}).done(function(b){bootbox.dialog(b,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var b=$("#textfile_edit_area").val();$.ajax({type:"POST",url:"execute.php?action=save_text_file",data:{path:d, path_thumb:c,new_content:b}}).done(function(b){""!=b&&bootbox.alert(b)})}}],{header:a.find(".name_download").val()})})} function change_lang(){$.ajax({type:"POST",url:"ajax_calls.php?action=get_lang",data:{}}).done(function(a){bootbox.dialog(a,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var a=$("#new_lang_select option:selected").val();$.ajax({type:"POST",url:"ajax_calls.php?action=change_lang",data:{choosen_lang:a}}).done(function(a){""!=a?bootbox.alert(a):setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},500)})}}], {header:$("#lang_lang_change").val()})})} function chmod(a){$("#files_permission_start").parent().parent().remove();if(a.hasClass("directory"))c=a.find(".rename-folder").attr("data-thumb"),d=a.find(".rename-folder").attr("data-path");else var c=a.find(".rename-file").attr("data-thumb"),d=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=chmod",data:{path:d,path_thumb:c}}).done(function(b){bootbox.dialog(b,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var b= $("#chmod_form #chmod_value").val();if(""!=b&&"undefined"!==typeof b){var a=$("#chmod_form input[name=apply_recursive]:checked").val();if(""==a||"undefined"===typeof a)a="none";$.ajax({type:"POST",url:"execute.php?action=chmod",data:{path:d,path_thumb:c,new_mode:b,is_recursive:a}}).done(function(b){""!=b&&bootbox.alert(b)})}}}],{header:$("#lang_file_permission").val()})})} function chmod_logic(a){var c=[];c.user=0;c.group=0;c.all=0;"undefined"!==typeof a&&1==a?(a=$("#chmod_form #chmod_value").val(),c.user=a.substr(0,1),c.group=a.substr(1,1),c.all=a.substr(2,1),$.each(c,function(a){if(""==c[a]||0==$.isNumeric(c[a])||0>parseInt(c[a])||7<parseInt(c[a]))c[a]="0"}),$("#chmod_form input:checkbox").each(function(){var a=$(this).attr("data-group"),b=$(this).attr("data-value");chmod_logic_helper(c[a],b)?$(this).prop("checked",!0):$(this).prop("checked",!1)})):($("#chmod_form input:checkbox:checked").each(function(){var a= $(this).attr("data-group"),b=$(this).attr("data-value");c[a]=parseInt(c[a])+parseInt(b)}),$("#chmod_form #chmod_value").val(c.user.toString()+c.group.toString()+c.all.toString()))}function chmod_logic_helper(a,c){a=parseInt(a);c=parseInt(c);return-1!=$.inArray(a,[,[1,3,5,7],[2,3,6,7],,[4,5,6,7]][c])?!0:!1} function clear_clipboard(){bootbox.confirm($("#lang_clear_clipboard_confirm").val(),$("#cancel").val(),$("#ok").val(),function(a){1==a&&$.ajax({type:"POST",url:"ajax_calls.php?action=clear_clipboard",data:{}}).done(function(a){""!=a?bootbox.alert(a):$("#clipboard").val("0");toggle_clipboard(!1)})})} function copy_cut_clicked(a,c){if("copy"==c||"cut"==c){if(a.hasClass("directory"))d=a.find(".rename-folder").attr("data-thumb"),b=a.find(".rename-folder").attr("data-path");else var d=a.find(".rename-file").attr("data-thumb"),b=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:b,path_thumb:d,sub_action:c}}).done(function(b){""!=b?bootbox.alert(b):($("#clipboard").val("1"),toggle_clipboard(!0))})}} function paste_to_this_dir(a){bootbox.confirm($("#lang_paste_confirm").val(),$("#cancel").val(),$("#ok").val(),function(c){if(1==c){if("undefined"!=typeof a){c=a.find(".rename-folder").attr("data-path");var d=a.find(".rename-folder").attr("data-thumb")}else c=$("#sub_folder").val()+$("#fldr_value").val(),d=$("#cur_dir_thumb").val();$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:c,path_thumb:d}}).done(function(b){""!=b?bootbox.alert(b):($("#clipboard").val("0"),toggle_clipboard(!1), setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300))})}})} function drag_n_drop_paste(a,c){if(a.hasClass("directory"))d=a.find(".rename-folder").attr("data-thumb"),b=a.find(".rename-folder").attr("data-path");else var d=a.find(".rename-file").attr("data-thumb"),b=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:b,path_thumb:d,sub_action:"cut"}}).done(function(b){if(""!=b)bootbox.alert(b);else{if("undefined"!=typeof c){b=c.find(".rename-folder").attr("data-path");var a=c.find(".rename-folder").attr("data-thumb")}else b= $("#sub_folder").val()+$("#fldr_value").val(),a=$("#cur_dir_thumb").val();$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:b,path_thumb:a}}).done(function(b){""!=b?bootbox.alert(b):($("#clipboard").val("0"),toggle_clipboard(!1),setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300))})}})} function toggle_clipboard(a){1==a?$(".paste-here-btn, .clear-clipboard-btn").removeClass("disabled"):$(".paste-here-btn, .clear-clipboard-btn").addClass("disabled")} function fix_colums(a){a=$(".breadcrumb").width()+a;$(".uploader").css("width",a);if(0<$("#view").val()){if(1==$("#view").val())$("ul.grid li, ul.grid figure").css("width","100%");else{var c=Math.floor(a/380);0==c&&(c=1,$("h4").css("font-size",12));a=Math.floor(a/c-3);$("ul.grid li, ul.grid figure").css("width",a)}$("#help").hide()}else Modernizr.touch&&$("#help").show()} function swipe_reaction(a,c,d,b,f){a=$(this);0==$("#view").val()&&(1==a.attr("toggle")?(a.attr("toggle",0),a.animate({top:"0px"},{queue:!1,duration:300})):(a.attr("toggle",1),a.animate({top:"-30px"},{queue:!1,duration:300})))}function encodeURL(a){a=a.split("/");for(var c=3;c<a.length;c++)a[c]=encodeURIComponent(a[c]);return a.join("/")} function apply(a,c){var d=1==$("#popup").val()?window.opener:window.parent,b=$("#cur_dir").val(),f=$("#base_url").val(),e=a.substr(0,a.lastIndexOf(".")),h=a.split(".").pop(),h=h.toLowerCase(),g="",g=["ogg","mp3","wav"],l=["mp4","ogg","webm"],b=f+b+a;""!=c?1==$("#crossdomain").val()?d.postMessage({sender:"responsivefilemanager",url:b,field_id:c},"*"):($("#"+c,d.document).val(b).trigger("change"),close_window()):(-1<$.inArray(h,ext_img)?g='<img src="'+b+'" alt="'+e+'" />':-1<$.inArray(h,l)?g='<video controls source src="'+ b+'" type="video/'+h+'">'+e+"</video>":-1<$.inArray(h,g)?("mp3"==h&&(h="mpeg"),g='<audio controls src="'+b+'" type="audio/'+h+'">'+e+"</audio>"):g='<a href="'+b+'" title="'+e+'">'+e+"</a>",1==$("#crossdomain").val()?d.postMessage({sender:"responsivefilemanager",url:b,field_id:null,html:g},"*"):4>parent.tinymce.majorVersion?(parent.tinymce.activeEditor.execCommand("mceInsertContent",!1,g),parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)): (parent.tinymce.activeEditor.insertContent(g),parent.tinymce.activeEditor.windowManager.close()))}function apply_link(a,c){var d=1==$("#popup").val()?window.opener:window.parent,b=$("#cur_dir").val(),b=b.replace("\\","/"),b=$("#base_url").val()+b+a;""!=c?1==$("#crossdomain").val()?d.postMessage({sender:"responsivefilemanager",url:b,field_id:c},"*"):($("#"+c,d.document).val(b).trigger("change"),close_window()):apply_any(b)} function apply_img(a,c){var d=1==$("#popup").val()?window.opener:window.parent,b=$("#cur_dir").val(),b=b.replace("\\","/"),b=$("#base_url").val()+b+a;""!=c?1==$("#crossdomain").val()?d.postMessage({sender:"responsivefilemanager",url:b,field_id:c},"*"):($("#"+c,d.document).val(b).trigger("change"),close_window()):apply_any(b)} function apply_video(a,c){var d=1==$("#popup").val()?window.opener:window.parent,b=$("#cur_dir").val(),b=b.replace("\\","/"),f=$("#base_url").val(),b=encodeURL(f+b+a);""!=c?1==$("#crossdomain").val()?d.postMessage({sender:"responsivefilemanager",url:b,field_id:c},"*"):($("#"+c,d.document).val(b).trigger("change"),close_window()):apply_any(b)} function apply_none(a,c){var d=$('li[data-name="'+a+'"]').find(".preview");""!=d.html()&&void 0!==d.html()?($("#full-img").attr("src",decodeURIComponent(d.attr("data-url"))),0==d.hasClass("disabled")&&(show_animation(),$("#previewLightbox").lightbox())):(d=$('li[data-name="'+a+'"]').find(".modalAV"),$("#previewAV").removeData("modal"),$("#previewAV").modal({backdrop:"static",keyboard:!1}),d.hasClass("audio")?$(".body-preview").css("height","80px"):$(".body-preview").css("height","345px"),$.ajax({url:decodeURIComponent(d.attr("data-url")), success:function(b){$(".body-preview").html(b)}}))} function apply_any(a){1==$("#crossdomain").val()?window.parent.postMessage({sender:"responsivefilemanager",url:a,field_id:null},"*"):4>parent.tinymce.majorVersion?(parent.tinymce.activeEditor.windowManager.params.setUrl(a),parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)):(parent.tinymce.activeEditor.windowManager.getParams().setUrl(a),parent.tinymce.activeEditor.windowManager.close());return!1} function close_window(){1==$("#popup").val()?window.close():"undefined"!==typeof parent.jQuery&&parent.jQuery?parent.jQuery.fancybox.close():parent.$.fancybox.close()} function apply_file_duplicate(a,c){var d=a.parent().parent().parent().parent();d.after("<li class='"+d.attr("class")+"' data-name='"+d.attr("data-name")+"'>"+d.html()+"</li>");d=d.next();apply_file_rename(d.find("figure"),c);var d=d.find(".download-form"),b="form"+(new Date).getTime();d.attr("id",b);d.find(".tip-right").attr("onclick","$('#"+b+"').submit();")} function apply_file_rename(a,c){a.attr("data-name",c);a.parent().attr("data-name",c);a.find("h4").find("a").text(c);var d=a.find("a.link"),b=d.attr("data-file"),f=b.substring(b.lastIndexOf("/")+1),e=b.substring(b.lastIndexOf(".")+1);d.each(function(){$(this).attr("data-file",encodeURIComponent(c+"."+e))});a.find("img").each(function(){var b=$(this).attr("src");$(this).attr("src",b.replace(f,c+"."+e)+"?time="+(new Date).getTime());$(this).attr("alt",c+" thumbnails")});d=a.find("a.preview");b=d.attr("data-url"); "undefined"!==typeof b&&b&&d.attr("data-url",b.replace(encodeURIComponent(f),encodeURIComponent(c+"."+e)));a.parent().attr("data-name",c+"."+e);a.attr("data-name",c+"."+e);a.find(".name_download").val(c+"."+e);var b=a.find("a.rename-file"),d=a.find("a.delete-file"),h=b.attr("data-path"),g=b.attr("data-thumb"),h=h.replace(f,c+"."+e),g=g.replace(f,c+"."+e);b.attr("data-path",h);b.attr("data-thumb",g);d.attr("data-path",h);d.attr("data-thumb",g)} function apply_folder_rename(a,c){a.attr("data-name",c);a.find("figure").attr("data-name",c);var d=a.find("h4").find("a").text();a.find("h4 > a").text(c);var b=a.find(".folder-link"),f=b.attr("href"),e=$("#fldr_value").val(),h=f.replace("fldr="+e+encodeURIComponent(d),"fldr="+e+encodeURIComponent(c));b.each(function(){$(this).attr("href",h)});var d=a.find("a.delete-folder"),b=a.find("a.rename-folder"),e=b.attr("data-path"),f=b.attr("data-thumb"),g=e.lastIndexOf("/"),e=e.substr(0,g+1)+c;d.attr("data-path", e);b.attr("data-path",e);g=f.lastIndexOf("/");e=f.substr(0,g+1)+c;d.attr("data-thumb",e);b.attr("data-thumb",e)}function replace_last(a,c,d){return a.replace(new RegExp(c+"$"),d)}function replaceDiacritics(a){for(var c=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],d="AaEeIiOoUuNnCc".split(""),b=0;b<c.length;b++)a=a.replace(c[b],d[b]);return a} function fix_filename(a){return null!=a?("true"==$("#transliteration").val()&&(a=replaceDiacritics(a),a=a.replace(/[^A-Za-z0-9\.\-\[\]\ \_]+/g,"")),"true"==$("#convert_spaces").val()&&(a=a.replace(" ","_")),a=a.replace('"',""),a=a.replace("'",""),a=a.replace("/",""),a=a.replace("\\",""),a=a.replace(/<\/?[^>]+(>|$)/g,""),$.trim(a)):null} function execute_action(a,c,d,b,f,e){null!==b&&(b=fix_filename(b),$.ajax({type:"POST",url:"execute.php?action="+a,data:{path:c,path_thumb:d,name:b.replace("/","")}}).done(function(a){if(""!=a)return bootbox.alert(a),!1;if(""!=e)window[e](f,b);return!0}))} function sortUnorderedList(a,c,d){"string"==typeof a&&(a=$(a));var b=a.find("li.dir");a=a.find("li.file");var f=[],e=[],h=[],g=[];$.each(b,function(b){b=$(this);var a=b.find(d).val();if($.isNumeric(a))for(a=parseFloat(a);"undefined"!==typeof f[a]&&f[a];)a=parseFloat(parseFloat(a)+.001);else a=a+"a"+b.find("h4 a").attr("data-file");f[a]=b.html();e.push(a)});$.each(a,function(b){b=$(this);var a=b.find(d).val();if($.isNumeric(a))for(a=parseFloat(a);"undefined"!==typeof h[a]&&h[a];)a=parseFloat(parseFloat(a)+ .001);else a=a+"a"+b.find("h4 a").attr("data-file");h[a]=b.html();g.push(a)});$.isNumeric(e[0])?e.sort(function(a,b){return parseFloat(a)-parseFloat(b)}):e.sort();$.isNumeric(g[0])?g.sort(function(a,b){return parseFloat(a)-parseFloat(b)}):g.sort();c&&(e.reverse(),g.reverse());$.each(b,function(a){$(this).html(f[e[a]])});$.each(a,function(a){$(this).html(h[g[a]])})}function show_animation(){$("#loading_container").css("display","block");$("#loading").css("opacity",".7")} function hide_animation(){$("#loading_container").fadeOut()}function launchEditor(a,c){featherEditor.launch({image:a,url:c});return!1};